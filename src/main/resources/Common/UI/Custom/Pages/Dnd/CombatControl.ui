// Combat Control Panel - TTRPG Plugin
// Uses shared Dnd.ui component library
$C = "../../Common.ui";
$D = "../../Dnd/Dnd.ui";

$C.@PageOverlay {
  $C.@Container {
    Anchor: (Width: 500, Height: 450);

    #Title {
      Group {
        $C.@Title {
          @Text = "Combat Control";
        }
        Label #combatStatus {
          Anchor: (Top: 5);
          Text: "No Active Combat";
          Style: (FontSize: 12, TextColor: #888888);
        }
      }
    }

    #Content {
      LayoutMode: Left;

      // === INITIATIVE COLUMN ===
      Group #InitiativeColumn {
        LayoutMode: Top;
        Anchor: (Width: 200);

        $D.@SectionHeader { @Text = "INITIATIVE ORDER"; }

        Group #InitiativeList {
          LayoutMode: Top;
          Background: #1a1a2e(0.5);
          Anchor: (Bottom: 10);

          $D.@EmptyStateMessage #noInitiativeMsg {
            @Text = "No combatants yet. Roll initiative to join!";
          }

          // Initiative slots 0-7
          Label #initEntry0 {
            Visible: false;
            Anchor: (Height: 18);
            Text: "1. Player (20)";
            Style: (FontSize: 11, TextColor: #cccccc);
          }
          Label #initEntry1 {
            Visible: false;
            Anchor: (Height: 18);
            Text: "2. Player (18)";
            Style: (FontSize: 11, TextColor: #cccccc);
          }
          Label #initEntry2 {
            Visible: false;
            Anchor: (Height: 18);
            Text: "3. Player (15)";
            Style: (FontSize: 11, TextColor: #cccccc);
          }
          Label #initEntry3 {
            Visible: false;
            Anchor: (Height: 18);
            Text: "4. Player (12)";
            Style: (FontSize: 11, TextColor: #cccccc);
          }
          Label #initEntry4 {
            Visible: false;
            Anchor: (Height: 18);
            Text: "5. Player (10)";
            Style: (FontSize: 11, TextColor: #cccccc);
          }
          Label #initEntry5 {
            Visible: false;
            Anchor: (Height: 18);
            Text: "6. Player (8)";
            Style: (FontSize: 11, TextColor: #cccccc);
          }
          Label #initEntry6 {
            Visible: false;
            Anchor: (Height: 18);
            Text: "7. Player (5)";
            Style: (FontSize: 11, TextColor: #cccccc);
          }
          Label #initEntry7 {
            Visible: false;
            Anchor: (Height: 18);
            Text: "8. Player (3)";
            Style: (FontSize: 11, TextColor: #cccccc);
          }
        }

        $D.@DndSecondaryButton #rollInitBtn {
          @Text = "Roll Initiative";
          @Width = 180;
        }
      }

      // === ACTION COLUMN ===
      Group #ActionColumn {
        LayoutMode: Top;
        FlexWeight: 1;
        Padding: (Left: 20);

        $D.@SectionHeader { @Text = "CURRENT TURN"; }

        $D.@TurnIndicator #CurrentTurnBox { }

        $D.@SectionHeader { @Text = "ACTIONS"; }

        Group #ActionButtons {
          LayoutMode: Top;

          $D.@DndButton #endTurnBtn {
            @Text = "End Turn";
            @Width = 220;
            @Height = 40;
            Anchor: (Bottom: 10);
          }

          Group {
            LayoutMode: Left;
            Anchor: (Height: 35, Bottom: 10);
            $D.@DndSecondaryButton #startCombatBtn {
              @Text = "Start";
              @Width = 105;
              Anchor: (Right: 5);
            }
            $D.@DndSecondaryButton #endCombatBtn {
              @Text = "End";
              @Width = 105;
              Anchor: (Left: 5);
            }
          }

          $D.@DndSecondaryButton #openSheetBtn {
            @Text = "Character Sheet";
            @Width = 220;
            Anchor: (Top: 10);
          }
        }

        Group #HelpText {
          LayoutMode: Top;
          Anchor: (Top: 20);

          $D.@TipsHeader { }

          $D.@HelpText { @Text = "- Roll initiative before starting combat"; }
          $D.@HelpText { @Text = "- Only current player can end their turn"; }
          $D.@HelpText { @Text = "- Use character sheet for dice rolls"; }
        }
      }
    }
  }
}
